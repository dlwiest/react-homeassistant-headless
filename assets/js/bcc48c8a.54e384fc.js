"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[3989],{4534:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"development-testing","title":"Development & Testing","description":"Building and testing Home Assistant interfaces requires tools that work when you don\'t have access to a real Home Assistant instance. hass-react provides mock mode and validation utilities to streamline development.","source":"@site/docs/development-testing.md","sourceDirName":".","slug":"/development-testing","permalink":"/docs/development-testing","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/development-testing.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Error Handling & Connection Status","permalink":"/docs/error-handling"}}');var o=t(4848),s=t(8453);const r={},a="Development & Testing",l={},d=[{value:"Mock Mode",id:"mock-mode",level:2},{value:"Mock Entity Behavior",id:"mock-entity-behavior",level:2},{value:"Mock Service Calls",id:"mock-service-calls",level:2},{value:"Development Environment Setup",id:"development-environment-setup",level:2},{value:"Validation and Development Warnings",id:"validation-and-development-warnings",level:2},{value:"Entity ID Format Validation",id:"entity-id-format-validation",level:3},{value:"Missing Entity Warnings",id:"missing-entity-warnings",level:3},{value:"Testing Patterns",id:"testing-patterns",level:2},{value:"Component Testing with Mock Data",id:"component-testing-with-mock-data",level:3},{value:"Integration Testing",id:"integration-testing",level:3},{value:"Mock Data Helpers",id:"mock-data-helpers",level:2},{value:"Environment Variables",id:"environment-variables",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"development--testing",children:"Development & Testing"})}),"\n",(0,o.jsx)(e.p,{children:"Building and testing Home Assistant interfaces requires tools that work when you don't have access to a real Home Assistant instance. hass-react provides mock mode and validation utilities to streamline development."}),"\n",(0,o.jsx)(e.h2,{id:"mock-mode",children:"Mock Mode"}),"\n",(0,o.jsxs)(e.p,{children:["Mock mode allows you to develop your interface without connecting to a real Home Assistant instance. Enable it by setting ",(0,o.jsx)(e.code,{children:"mockMode: true"})," in your HAProvider configuration:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import { HAProvider } from 'hass-react';\n\nconst mockEntities = {\n  'light.living_room': {\n    entity_id: 'light.living_room',\n    state: 'on',\n    attributes: {\n      friendly_name: 'Living Room Light',\n      brightness: 180,\n      color_temp: 3000\n    },\n    last_changed: '2024-01-15T10:30:00Z',\n    last_updated: '2024-01-15T10:30:00Z',\n    context: { id: '1', parent_id: null, user_id: null }\n  },\n  'sensor.temperature': {\n    entity_id: 'sensor.temperature',\n    state: '22.5',\n    attributes: {\n      friendly_name: 'Living Room Temperature',\n      unit_of_measurement: '\xb0C',\n      device_class: 'temperature'\n    },\n    last_changed: '2024-01-15T10:25:00Z',\n    last_updated: '2024-01-15T10:30:00Z',\n    context: { id: '2', parent_id: null, user_id: null }\n  }\n};\n\nfunction App() {\n  return (\n    <HAProvider \n      url=\"mock://localhost\" \n      mockMode={true} \n      mockData={mockEntities}\n    >\n      <YourApp />\n    </HAProvider>\n  );\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"mock-entity-behavior",children:"Mock Entity Behavior"}),"\n",(0,o.jsx)(e.p,{children:"Mock entities behave like real entities with state transitions:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"function MockLightDemo() {\n  const light = useLight('light.living_room');\n  \n  return (\n    <div>\n      <h3>{light.attributes.friendly_name}</h3>\n      <p>State: {light.isOn ? 'On' : 'Off'}</p>\n      <p>Brightness: {light.brightness}</p>\n      \n      {/* These actions will update mock state */}\n      <button onClick={light.toggle}>\n        {light.isOn ? 'Turn Off' : 'Turn On'}\n      </button>\n      \n      <button onClick={() => light.setBrightness(255)}>\n        Max Brightness\n      </button>\n    </div>\n  );\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"mock-service-calls",children:"Mock Service Calls"}),"\n",(0,o.jsx)(e.p,{children:"Service calls in mock mode simulate real behavior:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"function MockTodoDemo() {\n  const todos = useTodo('todo.shopping_list');\n  \n  const addItem = async () => {\n    // This works in mock mode and updates the mock state\n    await todos.addItem('Buy groceries');\n  };\n  \n  const toggleItem = async (uid: string) => {\n    // State transitions are simulated\n    await todos.toggleItem(uid);\n  };\n  \n  return (\n    <div>\n      <h3>Shopping List ({todos.itemCount} items)</h3>\n      \n      <ul>\n        {todos.items.map((item) => (\n          <li key={item.uid}>\n            <input \n              type=\"checkbox\"\n              checked={item.status === 'completed'}\n              onChange={() => toggleItem(item.uid)}\n            />\n            {item.summary}\n          </li>\n        ))}\n      </ul>\n      \n      <button onClick={addItem}>Add Item</button>\n      <button onClick={todos.clearCompleted}>Clear Completed</button>\n    </div>\n  );\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"development-environment-setup",children:"Development Environment Setup"}),"\n",(0,o.jsx)(e.p,{children:"Set up different configurations for development vs production:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"// config/environment.ts\ninterface AppConfig {\n  hassUrl: string;\n  mockMode: boolean;\n  mockData?: Record<string, any>;\n}\n\nconst config: AppConfig = {\n  hassUrl: process.env.NODE_ENV === 'development' \n    ? 'mock://localhost'\n    : process.env.REACT_APP_HASS_URL || 'http://homeassistant.local:8123',\n  \n  mockMode: process.env.NODE_ENV === 'development',\n  \n  mockData: process.env.NODE_ENV === 'development' ? {\n    'light.kitchen': {\n      entity_id: 'light.kitchen',\n      state: 'off',\n      attributes: { friendly_name: 'Kitchen Light', brightness: 0 },\n      last_changed: new Date().toISOString(),\n      last_updated: new Date().toISOString(),\n      context: { id: '1', parent_id: null, user_id: null }\n    },\n    'switch.coffee_maker': {\n      entity_id: 'switch.coffee_maker',\n      state: 'off',\n      attributes: { friendly_name: 'Coffee Maker' },\n      last_changed: new Date().toISOString(),\n      last_updated: new Date().toISOString(),\n      context: { id: '2', parent_id: null, user_id: null }\n    }\n  } : undefined\n};\n\nexport default config;\n"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"// App.tsx\nimport { HAProvider } from 'hass-react';\nimport config from './config/environment';\n\nfunction App() {\n  return (\n    <HAProvider \n      url={config.hassUrl}\n      mockMode={config.mockMode}\n      mockData={config.mockData}\n    >\n      <Dashboard />\n    </HAProvider>\n  );\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"validation-and-development-warnings",children:"Validation and Development Warnings"}),"\n",(0,o.jsx)(e.p,{children:"hass-react provides helpful validation during development:"}),"\n",(0,o.jsx)(e.h3,{id:"entity-id-format-validation",children:"Entity ID Format Validation"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"function BadExample() {\n  // This will show a console warning in development:\n  // \"Invalid entity ID format. Entity IDs should be in format domain.entity_name\"\n  const light = useLight('invalid_id_without_domain');\n  \n  return <div>This won't work properly</div>;\n}\n\nfunction GoodExample() {\n  // Proper entity ID format\n  const light = useLight('light.living_room');\n  \n  return <div>This works correctly</div>;\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"missing-entity-warnings",children:"Missing Entity Warnings"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"function EntityCheck() {\n  const light = useLight('light.nonexistent');\n  \n  // After 2 seconds, you'll see:\n  // \"Entity light.nonexistent not found in Home Assistant. \n  //  Check that the entity exists and is available.\"\n  \n  if (light.error) {\n    return <div>Entity not found: {light.error.message}</div>;\n  }\n  \n  return <div>Light: {light.state}</div>;\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"testing-patterns",children:"Testing Patterns"}),"\n",(0,o.jsx)(e.h3,{id:"component-testing-with-mock-data",children:"Component Testing with Mock Data"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"// tests/LightControl.test.tsx\nimport { render, fireEvent } from '@testing-library/react';\nimport { HAProvider } from 'hass-react';\nimport LightControl from '../components/LightControl';\n\nconst mockLightData = {\n  'light.test': {\n    entity_id: 'light.test',\n    state: 'off',\n    attributes: {\n      friendly_name: 'Test Light',\n      brightness: 0\n    },\n    last_changed: '2024-01-15T10:00:00Z',\n    last_updated: '2024-01-15T10:00:00Z',\n    context: { id: '1', parent_id: null, user_id: null }\n  }\n};\n\nfunction TestWrapper({ children }) {\n  return (\n    <HAProvider \n      url=\"mock://test\"\n      mockMode={true}\n      mockData={mockLightData}\n    >\n      {children}\n    </HAProvider>\n  );\n}\n\ntest('light control toggles state', async () => {\n  const { getByRole, findByText } = render(\n    <TestWrapper>\n      <LightControl entityId=\"light.test\" />\n    </TestWrapper>\n  );\n  \n  // Initial state\n  expect(await findByText('Off')).toBeInTheDocument();\n  \n  // Toggle light\n  fireEvent.click(getByRole('button', { name: /turn on/i }));\n  \n  // Check updated state\n  expect(await findByText('On')).toBeInTheDocument();\n});\n"})}),"\n",(0,o.jsx)(e.h3,{id:"integration-testing",children:"Integration Testing"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"// tests/integration/Dashboard.test.tsx\nimport { render, waitFor } from '@testing-library/react';\nimport { HAProvider } from 'hass-react';\nimport Dashboard from '../Dashboard';\n\nconst fullMockData = {\n  'light.living_room': { /* ... */ },\n  'sensor.temperature': { /* ... */ },\n  'switch.coffee_maker': { /* ... */ }\n};\n\ntest('dashboard displays all entities', async () => {\n  const { getByText } = render(\n    <HAProvider \n      url=\"mock://integration-test\"\n      mockMode={true}\n      mockData={fullMockData}\n    >\n      <Dashboard />\n    </HAProvider>\n  );\n  \n  await waitFor(() => {\n    expect(getByText('Living Room Light')).toBeInTheDocument();\n    expect(getByText('22.5\xb0C')).toBeInTheDocument();\n    expect(getByText('Coffee Maker')).toBeInTheDocument();\n  });\n});\n"})}),"\n",(0,o.jsx)(e.h2,{id:"mock-data-helpers",children:"Mock Data Helpers"}),"\n",(0,o.jsx)(e.p,{children:"Create reusable mock data generators:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"// utils/mockData.ts\nexport function createMockLight(\n  entityId: string, \n  overrides: Partial<any> = {}\n) {\n  return {\n    entity_id: entityId,\n    state: 'off',\n    attributes: {\n      friendly_name: entityId.replace('light.', '').replace('_', ' '),\n      brightness: 0,\n      supported_features: 1,\n      ...overrides.attributes\n    },\n    last_changed: new Date().toISOString(),\n    last_updated: new Date().toISOString(),\n    context: { id: Math.random().toString(), parent_id: null, user_id: null },\n    ...overrides\n  };\n}\n\nexport function createMockSensor(\n  entityId: string, \n  value: string,\n  overrides: Partial<any> = {}\n) {\n  return {\n    entity_id: entityId,\n    state: value,\n    attributes: {\n      friendly_name: entityId.replace('sensor.', '').replace('_', ' '),\n      unit_of_measurement: '\xb0C',\n      device_class: 'temperature',\n      ...overrides.attributes\n    },\n    last_changed: new Date().toISOString(),\n    last_updated: new Date().toISOString(),\n    context: { id: Math.random().toString(), parent_id: null, user_id: null },\n    ...overrides\n  };\n}\n\n// Usage\nconst mockData = {\n  'light.kitchen': createMockLight('light.kitchen', { state: 'on' }),\n  'light.bedroom': createMockLight('light.bedroom'),\n  'sensor.temperature': createMockSensor('sensor.temperature', '22.5'),\n  'sensor.humidity': createMockSensor('sensor.humidity', '45', {\n    attributes: { \n      unit_of_measurement: '%',\n      device_class: 'humidity'\n    }\n  })\n};\n"})}),"\n",(0,o.jsx)(e.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,o.jsx)(e.p,{children:"Use environment variables for flexible configuration:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# .env.development\nREACT_APP_MOCK_MODE=true\nREACT_APP_HASS_URL=mock://localhost\n\n# .env.production\nREACT_APP_MOCK_MODE=false\nREACT_APP_HASS_URL=http://homeassistant.local:8123\n"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"const config = {\n  mockMode: process.env.REACT_APP_MOCK_MODE === 'true',\n  hassUrl: process.env.REACT_APP_HASS_URL || 'http://localhost:8123'\n};\n"})}),"\n",(0,o.jsx)(e.p,{children:"Mock mode and validation utilities make it easy to develop and test Home Assistant interfaces without requiring a real instance, while ensuring your code works correctly when deployed to production."})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(c,{...n})}):c(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>a});var i=t(6540);const o={},s=i.createContext(o);function r(n){const e=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:r(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);