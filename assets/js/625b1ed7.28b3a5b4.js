"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1831],{5159:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"authentication","title":"Authentication","description":"hass-react supports both OAuth 2.0 and long-lived token authentication with automatic detection. Choose the method that works best for your setup.","source":"@site/docs/authentication.md","sourceDirName":".","slug":"/authentication","permalink":"/docs/authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/authentication.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Getting Started","permalink":"/docs/intro"},"next":{"title":"Light","permalink":"/docs/entities/light"}}');var i=t(4848),s=t(8453);const r={sidebar_position:2},c="Authentication",l={},a=[{value:"OAuth 2.0 (Recommended)",id:"oauth-20-recommended",level:2},{value:"Long-lived Token",id:"long-lived-token",level:2},{value:"Creating a Long-lived Token",id:"creating-a-long-lived-token",level:3},{value:"Auto-detection (Default)",id:"auto-detection-default",level:2},{value:"Connection Management",id:"connection-management",level:2},{value:"Monitoring Connection Status",id:"monitoring-connection-status",level:3},{value:"Logout (OAuth Only)",id:"logout-oauth-only",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"Connection Settings",id:"connection-settings",level:3},{value:"Service Call Retry",id:"service-call-retry",level:3},{value:"useAuth Hook",id:"useauth-hook",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"authentication",children:"Authentication"})}),"\n",(0,i.jsx)(e.p,{children:"hass-react supports both OAuth 2.0 and long-lived token authentication with automatic detection. Choose the method that works best for your setup."}),"\n",(0,i.jsx)(e.h2,{id:"oauth-20-recommended",children:"OAuth 2.0 (Recommended)"}),"\n",(0,i.jsx)(e.p,{children:"OAuth provides secure, user-friendly authentication without exposing tokens in your code:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:'<HAProvider url="http://homeassistant.local:8123" authMode="oauth">\n  <YourApp />\n</HAProvider>\n'})}),"\n",(0,i.jsx)(e.p,{children:"When using OAuth:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Users get a standard login flow"}),"\n",(0,i.jsx)(e.li,{children:"No tokens to manage or secure"}),"\n",(0,i.jsx)(e.li,{children:"Automatic token refresh"}),"\n",(0,i.jsx)(e.li,{children:"Users can revoke access from Home Assistant settings"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"long-lived-token",children:"Long-lived Token"}),"\n",(0,i.jsx)(e.p,{children:"Traditional token-based authentication for when you have a specific token:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:'<HAProvider \n  url="http://homeassistant.local:8123" \n  token="your-long-lived-access-token"\n>\n  <YourApp />\n</HAProvider>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"creating-a-long-lived-token",children:"Creating a Long-lived Token"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Open Home Assistant"}),"\n",(0,i.jsx)(e.li,{children:"Go to your profile (click your name in the sidebar)"}),"\n",(0,i.jsx)(e.li,{children:'Scroll to "Long-Lived Access Tokens"'}),"\n",(0,i.jsx)(e.li,{children:'Click "Create Token"'}),"\n",(0,i.jsx)(e.li,{children:"Give it a name and copy the generated token"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"auto-detection-default",children:"Auto-detection (Default)"}),"\n",(0,i.jsx)(e.p,{children:"By default, hass-react chooses the best authentication method automatically:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:'// Uses OAuth if no token provided\n<HAProvider url="http://homeassistant.local:8123">\n  <YourApp />\n</HAProvider>\n\n// Uses token auth if token provided  \n<HAProvider url="http://homeassistant.local:8123" token="your-token">\n  <YourApp />\n</HAProvider>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"connection-management",children:"Connection Management"}),"\n",(0,i.jsx)(e.h3,{id:"monitoring-connection-status",children:"Monitoring Connection Status"}),"\n",(0,i.jsxs)(e.p,{children:["Use the ",(0,i.jsx)(e.code,{children:"useHAConnection"})," hook to monitor connection health:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:"import { useHAConnection } from 'hass-react'\n\nfunction ConnectionIndicator() {\n  const { connected, connecting, error, reconnect } = useHAConnection()\n  \n  if (connecting) return <span>\ud83d\udd04 Connecting...</span>\n  if (!connected && error) return (\n    <div>\n      \u26a0\ufe0f Connection failed: {error.message}\n      <button onClick={reconnect}>Retry</button>\n    </div>\n  )\n  if (!connected) return <span>\ud83d\udd34 Disconnected</span>\n  return <span>\ud83d\udfe2 Connected</span>\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"logout-oauth-only",children:"Logout (OAuth Only)"}),"\n",(0,i.jsx)(e.p,{children:"For OAuth authentication, you can programmatically log users out:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:"import { useHAConnection } from 'hass-react'\n\nfunction LogoutButton() {\n  const { logout, connected } = useHAConnection()\n\n  return (\n    <button onClick={logout} disabled={!connected}>\n      Logout\n    </button>\n  )\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:"The logout function:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Clears stored OAuth tokens from localStorage"}),"\n",(0,i.jsx)(e.li,{children:"Immediately closes the WebSocket connection"}),"\n",(0,i.jsx)(e.li,{children:"Stops all entity controls from working"}),"\n",(0,i.jsx)(e.li,{children:"Triggers a new OAuth flow on the next connection attempt"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,i.jsx)(e.h3,{id:"connection-settings",children:"Connection Settings"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:'<HAProvider\n  url="http://homeassistant.local:8123"\n  options={{\n    reconnectInterval: 5000,    // Time between reconnection attempts (ms)\n    reconnectAttempts: 10,      // Max reconnection attempts\n    autoReconnect: true,        // Auto-reconnect on connection loss\n  }}\n/>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"service-call-retry",children:"Service Call Retry"}),"\n",(0,i.jsx)(e.p,{children:"Configure how service calls retry on failure:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:'<HAProvider\n  url="http://homeassistant.local:8123"\n  options={{\n    serviceRetry: {\n      maxAttempts: 3,           // Retry up to 3 times\n      baseDelay: 1000,          // Start with 1 second delay\n      exponentialBackoff: true, // Delays: 1s, 2s, 4s\n      maxDelay: 10000          // Cap delays at 10 seconds\n    }\n  }}\n/>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"useauth-hook",children:"useAuth Hook"}),"\n",(0,i.jsxs)(e.p,{children:["For custom authentication flows, use the ",(0,i.jsx)(e.code,{children:"useAuth"})," hook directly:"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:"import { useAuth } from 'hass-react'\n\nfunction CustomAuth() {\n  const { authenticated, login, logout, loading, error } = useAuth(\n    'http://homeassistant.local:8123',\n    'oauth'\n  )\n\n  if (loading) return <div>Authenticating...</div>\n  if (error) return <div>Error: {error.message}</div>\n  if (!authenticated) return <button onClick={login}>Login</button>\n  \n  return <button onClick={logout}>Logout</button>\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(e.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:'"Authentication failed"'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Check that your Home Assistant URL is correct and accessible"}),"\n",(0,i.jsx)(e.li,{children:"Ensure Home Assistant is running and reachable from your app"}),"\n",(0,i.jsx)(e.li,{children:"For tokens: verify the token hasn't expired or been revoked"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:'"Connection refused"'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Check the Home Assistant URL (including port 8123)"}),"\n",(0,i.jsx)(e.li,{children:"Verify your network connection"}),"\n",(0,i.jsx)(e.li,{children:"Check if Home Assistant is behind a firewall or proxy"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"OAuth redirect issues"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Ensure your app URL is whitelisted in Home Assistant"}),"\n",(0,i.jsx)(e.li,{children:"Check browser console for CORS or redirect errors"}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>c});var o=t(6540);const i={},s=o.createContext(i);function r(n){const e=o.useContext(s);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),o.createElement(s.Provider,{value:e},n.children)}}}]);